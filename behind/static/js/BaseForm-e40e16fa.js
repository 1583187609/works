import{d as e,r as a,a2 as s,aV as l,w as t,o,g as d,b as u,B as r,c as i,D as m,F as f,bz as n,a as c,G as p,e as b,f as v,u as x,bO as y,a3 as _,m as V,at as g,i as h,a_ as B,aZ as k,E as j}from"./rewrite-56f504a7.js";import{l as F}from"./lodash-878142d8.js";import{g as P}from"./system-fdbbef6b.js";import{_ as T}from"./_plugin-vue_export-helper-1b428a4d.js";const q={class:"all-hide-scroll box"},w={key:0,class:"f-c-c f-0 pt-o",style:{width:"100%"}},C={key:1,class:"f-c-c pb-o"},I=T(e({__name:"BaseForm",props:{modelValue:null,fields:{default:()=>[]},request:null,text:{type:Boolean,default:!1},footer:{type:Boolean,default:!0},submitText:{default:"提交"},resetText:{default:"重置"},extraParams:null,submitCb:null},emits:["submit","update:modelValue"],setup(e,{emit:T}){const I=e,E=g("closePopup"),{extraParams:O,submitText:U,submitCb:z}=I,D=a(!1),G=a(),L=s((()=>P(I.fields))),R=l(F.merge({labelWidth:L.value+"em"},{})),W=l({});function Z(e){return I.text&&(e.type="text"),e}I.fields.forEach((e=>{const{prop:a,value:s}=e;W[a]=s})),t((()=>I.modelValue),(e=>{if(e)for(let a in e)W[a]=e[a]}),{immediate:!0}),t(W,(e=>{T("update:modelValue",e)}),{immediate:!0,deep:!0});const $=()=>{const e=G.value;e&&e.validate(((e,a)=>{if(e){const e=F.merge({},O,W);(null==I?void 0:I.request)?(D.value=!0,I.request(e).then((e=>{j.success(U+"成功"),z?z():E()})).finally((()=>{D.value=!1}))):T("submit",e)}else{const e=Object.values(a)[0][0];j.error(e.message)}}))},A=()=>{const e=G.value;e&&e.resetFields()};return(a,s)=>{const l=h("BaseFormItem"),t=h("BaseIcon"),g=h("el-button"),j=h("el-form"),F=B("debounce");return e.fields.length?(o(),d(j,V({key:0,class:"base-form f-fs-s-c",model:W},R,{ref_key:"formRef",ref:G}),{default:u((()=>[r("div",q,[(o(!0),i(f,null,m(e.fields,((e,s)=>(o(),d(l,{field:Z(e),modelValue:W[e.prop],"onUpdate:modelValue":a=>W[e.prop]=a,key:s},{custom:u((({field:e})=>[k(a.$slots,e.prop,{field:e,form:W},void 0,!0)])),_:2},1032,["field","modelValue","onUpdate:modelValue"])))),128))]),!e.text&&e.footer?(o(),i("div",w,[n((o(),d(g,{type:"primary",disabled:D.value},{icon:u((()=>[c(t,{class:p({rotate:D.value}),name:D.value?"Loading":"Promotion"},null,8,["class","name"])])),default:u((()=>[b(" "+v(x(U)),1)])),_:1},8,["disabled"])),[[F,$,void 0,{immediate:!0}]]),c(g,{icon:x(y),onClick:A,disabled:D.value},{default:u((()=>[b(v(e.resetText),1)])),_:1},8,["icon","disabled"])])):_("",!0)])),_:3},16,["model"])):(o(),i("div",C,"空空如也~"))}}}),[["__scopeId","data-v-d72df2ae"]]);export{I as default};
