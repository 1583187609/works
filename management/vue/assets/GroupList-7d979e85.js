import e from"./AddDelBtn-20d045b4.js";import{M as a,q as l,aK as s,aM as t,bs as u,aR as o,aE as r,u as d,aP as p,F as i,s as m,am as n,I as f,b_ as c,bN as v,cc as V,bH as g}from"./index-3bafcaf7.js";import{g as x,h}from"./_utils-89ec2a56.js";const y=g(a({__name:"GroupList",props:{modelValue:{},parentProp:{default:""},fields:{default:()=>[]},pureText:{type:Boolean}},emits:["update:modelValue","change"],setup(a,{emit:g}){const y=a,_=g,b=x(y.fields),P=l({get:()=>y.modelValue,set(e){_("update:modelValue",e)}}),T=s({}),j=t([]);function k(e,a){if("add"===e){if(function(){const e=Object.values(P.value.slice(-1)[0]);return!e.length||e.some((e=>V.includes(e)))}())return void v.error("请将最后一项填写完毕后，再新增！");P.value.push(JSON.parse(JSON.stringify(b)))}else{if("del"!==e)throw new Error(`暂不支持${e}类型`);P.value.splice(a,1)}}return u((()=>y.fields),(e=>{const{modelValue:a}=y,l=h(e,_,a),{data:s,fields:t}=l;c.merge(T,s),j.value=t}),{immediate:!0}),u((()=>y.modelValue),(e=>{c.merge(T,e)}),{immediate:!1,deep:!0}),u(T,(e=>{c.merge(y.modelValue,e)}),{immediate:!1,deep:!0}),(a,l)=>{const s=o("BaseFormItem");return r(!0),d(i,null,p(P.value,((l,t)=>(r(),d("div",{class:"group-item f-fs-fs-w",key:t},[(r(!0),d(i,null,p(j.value,((e,l)=>(r(),m(s,n({prefixProp:`${a.parentProp}[${t}].`,field:e,pureText:e.pureText||a.pureText,modelValue:P.value[t][e.prop],"onUpdate:modelValue":a=>P.value[t][e.prop]=a},e,{key:l}),null,16,["prefixProp","field","pureText","modelValue","onUpdate:modelValue"])))),128)),f(e,{onClick:e=>k(e,t),type:t<P.value.length-1?"del":"add"},null,8,["onClick","type"])])))),128)}}}),[["__scopeId","data-v-4dae5fe8"]]);export{y as default};
