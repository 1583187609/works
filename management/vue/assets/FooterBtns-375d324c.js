import{M as e,aa as a,aM as s,q as t,bs as o,aR as n,aS as l,aE as i,u as d,bz as c,s as u,bx as m,I as r,ao as b,H as f,b3 as p,t as h,F as v,aP as B,bc as x,cJ as y,ce as g,ca as k,ck as T,cf as P,bN as R,cg as S,bH as _}from"./index-3bafcaf7.js";import{g as F}from"./index-51f0779e.js";const q={class:"footer-btns f-c-c f-0 pt-h pb-h"},j=_(e({__name:"FooterBtns",props:{loading:{type:Boolean},submitText:{default:"提交"},resetText:{default:"重置"},moreBtns:{default:()=>[]},formRef:{},isOmit:{type:Boolean,default:!0},log:{type:Boolean},debug:{type:Boolean},params:{},fetch:{},fetchSuccess:{},fetchFail:{},noSubmitProps:{},handleReq:{},disabled:{type:Boolean}},emits:["moreBtns","submit"],setup(e,{expose:_,emit:j}){const C=a("closePopup"),I=e,O=j,H=s(!1),M=t((()=>I.moreBtns.map((e=>F(e)))));function V(){const{log:e,debug:a,isOmit:s,noSubmitProps:t}=I;return new Promise(((o,n)=>{let{params:l,formRef:i,handleReq:d}=I;i&&i.validate(((i,c)=>{if(i){if(l=g(l),d&&(l=d(l)),s&&(l=k(l)),l=T(l,t),(e||a)&&(P(l,"req"),a))return;o(l)}else{const e=Object.values(c)[0][0];R.error(e.message),n(e)}}))}))}o((()=>I.loading),(e=>{H.value=e}));const w=(e=I.submitText+"成功！",a,s,t=!0)=>{S(e),C(a),null==s||s()};function z(){V().then((e=>{const{log:a,fetch:s,fetchSuccess:t=w,fetchFail:o}=I;s?(H.value=!0,s(e).then((e=>{a&&P(e,"res"),t(I.submitText+"成功！")})).catch((()=>{null==o||o()})).finally((()=>{H.value=!1}))):O("submit",e)})).catch((()=>{}))}function E(){const{formRef:e}=I;e&&e.resetFields()}function J(e){const{name:a,needValid:s,to:t}=e;void 0===t&&(s?V().then((e=>{O("moreBtns",a,e,w)})).catch((()=>{})):O("moreBtns",a,I.params,w))}return _({formValidate:V,submit:z}),(e,a)=>{const s=n("BaseIcon"),t=n("el-button"),o=n("BaseBtn"),g=l("debounce");return i(),d("div",q,[e.submitText?c((i(),u(t,{key:0,type:"primary",disabled:e.disabled||H.value},{icon:m((()=>[r(s,{class:b({rotate:H.value}),name:H.value?"Loading":"Promotion"},null,8,["class","name"])])),default:m((()=>[f(" "+p(e.submitText),1)])),_:1},8,["disabled"])),[[g,z,void 0,{immediate:!0}]]):h("",!0),(i(!0),d(v,null,B(M.value,((a,s)=>(i(),d(v,{key:s},[a.popconfirm?(i(),u(o,{key:0,onClick:e=>J(a),name:a,disabled:e.disabled},null,8,["onClick","name","disabled"])):c((i(),u(o,{key:1,name:a,disabled:e.disabled},null,8,["name","disabled"])),[[g,()=>J(a),void 0,{immediate:!0}]])],64)))),128)),e.resetText?(i(),u(t,{key:1,icon:x(y),onClick:E,disabled:e.disabled||H.value},{default:m((()=>[f(p(e.resetText),1)])),_:1},8,["icon","disabled"])):h("",!0)])}}}),[["__scopeId","data-v-a3841589"]]);export{j as default};
