import{r as I}from"./index-4a03ead4.js";import{g as M}from"./index-d2b43e08.js";import"./common-f4827de9.js";import{s as O,o as j,f as N,p as g,c as z}from"./system-a8d5b9ab.js";import{ay as A}from"./index-79ac556c.js";import{q as G,Q as J,r as K,e as Q,w as $,a6 as h,af as H,t as l,v as _,G as y,D as m,E as b,L as U,z as W,J as k,K as C,I as T,F as P,a0 as X,u as Y}from"./runtime-core.esm-bundler-95bf9971.js";import{_ as Z}from"./_plugin-vue_export-helper-c27b6911.js";const ee={class:"footer-btns f-c-c f-0 pt-h pb-h"},te=G({__name:"FooterBtns",props:{loading:{type:Boolean},submitText:{default:"提交"},resetText:{default:"重置"},moreBtns:{default:()=>[]},formRef:{},isOmit:{type:Boolean,default:!0},log:{type:Boolean},debug:{type:Boolean},params:{},fetch:{},fetchSuccess:{},fetchFail:{},noSubmitProps:{},handleReq:{},disabled:{type:Boolean}},emits:["moreBtns","submit"],setup(w,{expose:x,emit:F}){const R=J("closePopup"),r=w,u=F,i=K(!1),S=Q(()=>r.moreBtns.map(e=>M(e)));$(()=>r.loading,e=>{i.value=e});function f(){const{log:e,debug:o,isOmit:s,noSubmitProps:n}=r;return new Promise((a,d)=>{let{params:t,formRef:c,handleReq:p}=r;c&&c.validate((D,E)=>{if(D){if(t=O(t),p&&(t=p(t)),s&&(t=j(t)),t=N(t,n),(e||o)&&(g(t,"req"),o))return;a(t)}else{const v=Object.values(E)[0][0];A.error(v.message),d(v)}})})}const L=(e=r.submitText+"成功！",o,s,n=!0)=>{z(e),R(o),s==null||s()};function V(){f().then(e=>{const{log:o,fetch:s,fetchSuccess:n=L,fetchFail:a}=r;s?(i.value=!0,s(e).then(d=>{o&&g(d,"res"),n(r.submitText+"成功！")}).catch(()=>{a==null||a()}).finally(()=>{i.value=!1})):u("submit",e)}).catch(()=>{})}function q(){const{formRef:e}=r;e&&e.resetFields()}function B(e){const{name:o,needValid:s,to:n}=e;n===void 0&&(s?f().then(a=>{u("moreBtns",o,a)}).catch(()=>{}):u("moreBtns",o))}return x({formValidate:f}),(e,o)=>{const s=h("BaseIcon"),n=h("el-button"),a=h("BaseBtn"),d=H("debounce");return l(),_("div",ee,[e.submitText?y((l(),m(n,{key:0,type:"primary",disabled:e.disabled||i.value},{icon:b(()=>[U(s,{class:W({rotate:i.value}),name:i.value?"Loading":"Promotion"},null,8,["class","name"])]),default:b(()=>[k(" "+C(e.submitText),1)]),_:1},8,["disabled"])),[[d,V,void 0,{immediate:!0}]]):T("",!0),(l(!0),_(P,null,X(S.value,(t,c)=>(l(),_(P,{key:c},[t.popconfirm?(l(),m(a,{key:0,onClick:p=>B(t),name:t,disabled:e.disabled},null,8,["onClick","name","disabled"])):y((l(),m(a,{key:1,name:t,disabled:e.disabled},null,8,["name","disabled"])),[[d,()=>B(t),void 0,{immediate:!0}]])],64))),128)),e.resetText?(l(),m(n,{key:1,icon:Y(I),onClick:q,disabled:e.disabled||i.value},{default:b(()=>[k(C(e.resetText),1)]),_:1},8,["icon","disabled"])):T("",!0)])}}});const de=Z(te,[["__scopeId","data-v-08e1e8d5"]]);export{de as F};
