import{d as e,_ as t,e as o,j as s,f as a,ah as l,o as r,O as i,P as p,a as m,c as n,a8 as u,J as d,U as f,ac as c,L as v,u as j,S as h,I as b,K as x,F as y,a9 as g}from"./@vue-022d9836.js";import"./dayjs-21617033.js";import{i as k,m as B,k as T,t as F,x as V,_}from"./index-8cf28f90.js";import{l as S}from"./lodash-8dc1f9dc.js";import{h as O}from"./_utils-f23ae63f.js";import R from"./FooterBtns-bbeb9770.js";import{d as C}from"./_config-c0994392.js";import"./call-bind-ada3a9fc.js";import"./get-intrinsic-176af07e.js";import"./es-errors-c8ed318b.js";import"./has-symbols-456daba2.js";import"./has-proto-c2a23985.js";import"./function-bind-afbcd6f2.js";import"./hasown-c3b72c9b.js";import"./set-function-length-968dc075.js";import"./define-data-property-9d7bf764.js";import"./es-define-property-c2edbfb6.js";import"./gopd-16a4ddf0.js";import"./has-property-descriptors-52e43c9d.js";import"./xlsx-c1bdd32b.js";import"./element-plus-6dad9269.js";import"./lodash-es-d4f5f48c.js";import"./@vueuse-c70f8764.js";import"./@element-plus-91223246.js";import"./@popperjs-b78c3215.js";import"./@ctrl-91de2ec7.js";import"./async-validator-cf877c1f.js";import"./memoize-one-63ab667a.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui-3c499e77.js";import"./qs-fd29a741.js";import"./side-channel-5a41c40a.js";import"./object-inspect-0d550a97.js";import"./axios-86de682d.js";import"./pinia-f80f4126.js";import"./mock-ada1f893.js";import"./mockjs-217213d3.js";import"./vue-router-e17d6507.js";import"./nprogress-b5e58671.js";import"./vite-plugin-mock-6db8ade2.js";import"./path-to-regexp-83a43451.js";import"./index-0a44dd7a.js";const q=["onClick"],P={class:"title f-fs-c"},$={class:"line-1"},U={key:1,class:"f-c-c pb-o"},w=_(e({name:"SectionForm",__name:"SectionForm",props:{modelValue:{default:()=>t({})},sections:{default:()=>[]},pureText:{type:Boolean},foldable:{type:Boolean,default:!0},fetch:{},fetchSuccess:{},fetchFail:{},footer:{type:Boolean,default:!0},span:{default:24},submitText:{},resetText:{},extraParams:{},moreBtns:{},loading:{type:Boolean},isOmit:{type:Boolean,default:!0},log:{type:Boolean,default:!k},debug:{type:Boolean},autoFixedFoot:{type:Boolean,default:!0},noSubmitProps:{},labelWidthBySection:{type:Boolean,default:!0},handleReq:{}},emits:["update:modelValue","submit","change","moreBtns"],setup(e,{expose:t,emit:k}){const _=e,w=k,I=o(null),N=o([]),z=o(),W=s((()=>{const e=Math.max(..._.sections.map(((e,t)=>{var o;if("Object"!==F(e))return 0;const s=e,{fold:a=!1}=s;return N.value[t]=a,null==(o=s.fields)||o.map((e=>{if("Object"!==F(e))return e;const t=e;return t.attrs=S.merge({},s.attrs,t.attrs),t})),V(null==s?void 0:s.fields)})));return S.merge({labelWidth:e+"em"},C)})),L=o([]),A=s({get:()=>_.modelValue,set(e){w("update:modelValue",e)}}),J=s((()=>S.merge({},A.value,_.extraParams)));function K(){_.fetch?I.value.submit():w("submit",J.value)}return a((()=>_.sections),(e=>{const{modelValue:t,labelWidthBySection:o}=_;L.value=e.filter((e=>{if("Object"!==F(e))return!1;const{type:s,prop:a,fields:l,fieldAttrs:r}=e;if("Undefined"!==F(a)){const e=null==t?void 0:t[a];A.value[a]="custom"===s?e:O(l,w,e).data}else{const s=O(l,w,t,r);let{data:a,fields:i}=s;if(S.merge(A.value,a),o){const e=V(l);i=i.map(((t,o)=>(t.labelWidth=e+"em",t)))}e.fields=i}return!0}))}),{immediate:!0,deep:!0}),t({formRef:z,formValidate:()=>I.value.formValidate()}),(e,t)=>{const o=l("BaseIcon"),s=l("el-popover"),a=l("BaseFormItem"),k=l("el-form");return r(),i(k,v({class:"section-form f-fs-s-c",model:A.value},W.value,{onKeyup:g(K,["enter"]),ref_key:"formRef",ref:z}),{default:p((()=>[m("div",{class:d(["all-hide-scroll f-fs-s-w",{"auto-fixed-foot":e.autoFixedFoot}])},[L.value.length?(r(!0),n(y,{key:0},u(L.value,((l,g)=>(r(),n("section",{class:d(["section",{[`f-span-${l.span??24}`]:!0}]),key:g},[m("div",{onClick:e=>{return t=g,void((null==(s=null==(o=e.target)?void 0:o.classList)?void 0:s.contains("head"))&&(N.value[t]=!N.value[t]));var t,o,s},class:"head f-sb-c"},[m("div",P,[m("span",$,f(l.title),1),l.popover?(r(),i(s,c(v({key:0},j(B)(l.popover))),{reference:p((()=>[l.popover?(r(),i(o,{key:0,color:j(T).colorInfo,class:"ml-q",name:"QuestionFilled"},null,8,["color"])):h("",!0)])),_:2},1040)):h("",!0)]),b(e.$slots,"right-"+(l.prop??g),{},void 0,!0),e.foldable?(r(),i(o,{key:0,onClick:e=>N.value[g]=!N.value[g],class:d(["fold-btn f-0",N.value[g]?"rotate-180":""]),size:"1.5em",name:"CaretTop"},null,8,["onClick","class"])):h("",!0)],8,q),m("div",{class:"body f-fs-fs-w",style:x({"max-height":N.value[g]?"0":"100vh"})},["custom"===l.type?b(e.$slots,l.prop,{key:0,form:A.value},void 0,!0):(r(!0),n(y,{key:1},u(l.fields,((o,s)=>(r(),n(y,{key:o.key||s},[l.prop?(r(),i(a,{key:0,className:`f-span-${o.span||e.span}`,field:o,pureText:o.pureText||l.pureText||e.pureText,modelValue:A.value[l.prop][o.prop],"onUpdate:modelValue":e=>A.value[l.prop][o.prop]=e,onChange:t[0]||(t[0]=(e,t)=>w("change",e,t))},{custom:p((({field:t})=>[b(e.$slots,t.prop,{field:t,form:A.value},void 0,!0)])),_:2},1032,["className","field","pureText","modelValue","onUpdate:modelValue"])):(r(),i(a,{key:1,className:`f-span-${o.span||e.span}`,field:o,pureText:o.pureText||l.pureText||e.pureText,modelValue:A.value[o.prop],"onUpdate:modelValue":e=>A.value[o.prop]=e,onChange:t[1]||(t[1]=(e,t)=>w("change",e,t))},{custom:p((({field:t})=>[b(e.$slots,t.prop,{field:t,form:A.value},void 0,!0)])),_:2},1032,["className","field","pureText","modelValue","onUpdate:modelValue"]))],64)))),128))],4)],2)))),128)):(r(),n("div",U,"空空如也~"))],2),!e.pureText&&e.footer?(r(),i(R,{key:0,loading:e.loading,moreBtns:e.moreBtns,submitText:e.submitText,resetText:e.resetText,formRef:z.value,isOmit:e.isOmit,log:e.log,debug:e.debug,params:J.value,fetch:e.fetch,fetchSuccess:e.fetchSuccess,fetchFail:e.fetchFail,noSubmitProps:e.noSubmitProps,handleReq:e.handleReq,disabled:!L.value.length,onMoreBtns:t[2]||(t[2]=(e,t,o)=>w("moreBtns",e,t,o)),onSubmit:t[3]||(t[3]=e=>w("submit",e)),ref_key:"footerBtnsRef",ref:I},null,8,["loading","moreBtns","submitText","resetText","formRef","isOmit","log","debug","params","fetch","fetchSuccess","fetchFail","noSubmitProps","handleReq","disabled"])):h("",!0)])),_:3},16,["model"])}}}),[["__scopeId","data-v-afe9de7b"]]);export{w as default};
