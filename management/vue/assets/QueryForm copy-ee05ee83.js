import{M as W,ak as Z,aK as J,c8 as X,bd as Y,aM as y,q as B,bs as ee,bZ as S,bL as te,cA as ae,aR as p,aS as se,aE as v,s as h,bx as l,v as oe,aq as le,u as ne,F as re,aP as ue,am as N,I as g,bc as k,aQ as ce,bz as ie,ao as z,H as F,cG as me,b3 as de,t as A,cp as fe,bN as pe,bH as ve}from"./index-0bf49a0e.js";import{h as ge}from"./_utils-9ecd71f9.js";var D,x,I;const _e=W({__name:"QueryForm copy",props:Z({modelValue:{},fields:{},loading:{type:Boolean},rowNum:{},extraParams:{},inputDebounce:{type:Boolean},colSpanAttrs:{},isCompact:{type:Boolean},noFieldsHide:{type:Boolean}},Object.assign({rowNum:2,fields:()=>[],modelValue:()=>J({}),noFieldsHide:!0},(I=(x=(D=X)==null?void 0:D.BaseCrud)==null?void 0:x._components)==null?void 0:I.QueryForm)),emits:["update:modelValue","search","change","reset"],setup(H,{expose:M,emit:q}){const E={},o=H,u=q;let C=!0;const V=Y(),_=y(),c=y(2),r=y(!0),i=y([]),m=V.size==="small",L=B(()=>{if(r.value)return c.value>1?c.value*o.rowNum-1:1*o.rowNum}),n=B({get(){return o.modelValue},set(e){u("update:modelValue",e)}});ee(()=>o.fields,e=>{const{modelValue:t}=o,a=ge(e,void 0,t),{data:s,fields:b}=a;i.value=b,S.merge(n.value,s),u("change",n.value,C?!!t:!1),C=!1},{immediate:!0,deep:!0}),te("resize",()=>c.value=j(),!0);function Q(){return r.value?(c.value>1?o.rowNum:o.rowNum+1)*(m?28:40)+"px":"35vh"}function P(){const{fields:e,isCompact:t}=o,a=fe(e,m?.5:t?1:void 0);return Object.assign({labelWidth:a+"em"},E)}function j(){const{colSpanAttrs:e}=o,t={},a=ae();for(let s in e)t[s]=24/e[s];return t[a]}function O(e){const{colSpanAttrs:t}=o,{span:a,type:s}=e;return a?{span:a}:t}function R(){const e=_.value;e&&e.validate((t,a)=>{if(t){const{extraParams:s}=o;u("search",S.merge({},s,n.value))}else{const s=Object.values(a)[0][0];pe.error(s.message)}})}function $(){var e;(e=_.value)==null||e.resetFields(),u("reset")}return M({formRef:_,fields:i.value}),(e,t)=>{const a=p("BaseFormItem"),s=p("el-col"),b=p("BaseIcon"),w=p("el-button"),T=p("el-form"),U=se("debounce");return!e.noFieldsHide||i.value.length?(v(),h(T,N({key:0,class:["query-form",{compact:e.isCompact,small:m}],model:n.value},P(),{ref_key:"formRef",ref:_}),{default:l(()=>[oe("div",{class:"f-fs-fs-w fields-box all-hide-scroll",style:le({maxHeight:Q()})},[(v(!0),ne(re,null,ue(i.value.slice(0,L.value),(d,G)=>(v(),h(s,N(O(d),{key:G}),{default:l(()=>[g(a,{className:m?"mb-qtr":"mb-half",style:{width:"100%"},field:d,inputDebounce:e.inputDebounce,size:k(V).size,onChange:t[0]||(t[0]=(f,K)=>u("change",{[f]:K})),modelValue:n.value[d.prop],"onUpdate:modelValue":f=>n.value[d.prop]=f},{custom:l(({field:f})=>[ce(e.$slots,"custom",{field:f,form:n.value},void 0,!0)]),_:2},1032,["className","field","inputDebounce","size","modelValue","onUpdate:modelValue"])]),_:2},1040))),128)),g(s,N(e.colSpanAttrs,{class:["f-fe-fs fold-col",m?"mb-qtr":"mb-half"]}),{default:l(()=>[ie((v(),h(w,{type:"primary",disabled:e.loading},{icon:l(()=>[g(b,{class:z({rotate:e.loading}),name:e.loading?"Loading":"Search"},null,8,["class","name"])]),default:l(()=>[F("搜索")]),_:1},8,["disabled"])),[[U,R,void 0,{immediate:!0}]]),g(w,{icon:k(me),onClick:$,disabled:e.loading},{default:l(()=>[F("重置")]),_:1},8,["icon","disabled"]),i.value.length>c.value*e.rowNum-1?(v(),h(w,{key:0,onClick:t[1]||(t[1]=d=>r.value=!r.value),text:"",type:"primary"},{icon:l(()=>[g(b,{name:"ArrowDown",class:z({"rotate-180":!r.value,"icon-fold":!0})},null,8,["class"])]),default:l(()=>[F(" "+de(r.value?"展开":"折叠"),1)]),_:1})):A("",!0)]),_:1},16,["class"])],4)]),_:3},16,["class","model"])):A("",!0)}}});const he=ve(_e,[["__scopeId","data-v-8e4efc27"]]);export{he as default};
