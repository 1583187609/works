import{M as D,aK as Q,ce as H,aM as B,q as R,c2 as k,cd as F,cc as N,bs as G,aR as T,aE as n,s as f,bx as S,v as h,ao as _,u as y,F as $,aP as A,b3 as J,ap as X,am as L,bc as M,ct as Y,cr as Z,t as V,aQ as x,aq as I,bA as ee,bH as oe}from"./index-95e659d0.js";import{h as U}from"./_utils-ee6ed3b9.js";import{F as te}from"./FooterBtns-0a071bbf.js";import{d as ae}from"./_config-c76f4e31.js";const se=["onClick"],re={class:"title f-fs-c"},le={class:"line-1"},ne={key:1,class:"f-c-c pb-o"},ue=D({__name:"SectionForm",props:{modelValue:{default:()=>Q({})},sections:{default:()=>[]},pureText:{type:Boolean},foldable:{type:Boolean,default:!0},fetch:{},fetchSuccess:{},fetchFail:{},footer:{type:Boolean,default:!0},span:{default:24},submitText:{},resetText:{},extraParams:{},moreBtns:{},loading:{type:Boolean},isOmit:{type:Boolean,default:!0},log:{type:Boolean,default:!H},debug:{type:Boolean},autoFixedFoot:{type:Boolean,default:!0},noSubmitProps:{},labelWidthBySection:{type:Boolean,default:!0},handleReq:{}},emits:["update:modelValue","submit","change","moreBtns"],setup(z,{expose:W,emit:j}){const v=z,i=j,O=B(null),d=B([]),C=B(),E=R(()=>{const e=Math.max(...v.sections.map((t,p)=>{var m;if(k(t)!=="Object")return 0;const r=t,{fold:c=!1}=r;return d.value[p]=c,(m=r.fields)==null||m.map(o=>{if(k(o)!=="Object")return o;const l=o;return l.attrs=F.merge({},r.attrs,l.attrs),l}),N(r==null?void 0:r.fields)}));return F.merge({labelWidth:e+"em"},ae)}),g=B([]),u=R({get(){return v.modelValue},set(e){i("update:modelValue",e)}}),w=R(()=>F.merge({},u.value,v.extraParams));G(()=>v.sections,e=>{const{modelValue:t,labelWidthBySection:p}=v;g.value=e.filter(r=>{if(k(r)!=="Object")return!1;const{type:c,prop:m,fields:o,fieldAttrs:l}=r;if(k(m)!=="Undefined"){const a=t==null?void 0:t[m];u.value[m]=c==="custom"?a:U(o,i,a).data}else{const a=U(o,i,t,l);let{data:P,fields:s}=a;if(F.merge(u.value,P),p){const b=N(o);s=s.map((q,pe)=>(q.labelWidth=b+"em",q))}r.fields=s}return!0})},{immediate:!0,deep:!0});function K(e,t){var p,r;(r=(p=e.target)==null?void 0:p.classList)!=null&&r.contains("head")&&(d.value[t]=!d.value[t])}return W({formRef:C,formValidate(){return O.value.formValidate()}}),(e,t)=>{const p=T("BaseIcon"),r=T("el-popover"),c=T("BaseFormItem"),m=T("el-form");return n(),f(m,L({class:"section-form f-fs-s-c",model:u.value},E.value,{onKeyup:t[4]||(t[4]=ee(o=>i("submit",w.value),["enter"])),ref_key:"formRef",ref:C}),{default:S(()=>[h("div",{class:_(["all-hide-scroll f-fs-s-w",{"auto-fixed-foot":e.autoFixedFoot}])},[g.value.length?(n(!0),y($,{key:0},A(g.value,(o,l)=>(n(),y("section",{class:_(["section",{[`f-span-${o.span??24}`]:!0}]),key:l},[h("div",{onClick:a=>K(a,l),class:"head f-sb-c"},[h("div",re,[h("span",le,J(o.title),1),o.popover?(n(),f(r,X(L({key:0},M(Y)(o.popover))),{reference:S(()=>[o.popover?(n(),f(p,{key:0,color:M(Z).colorInfo,class:"icon-popover",name:"QuestionFilled"},null,8,["color"])):V("",!0)]),_:2},1040)):V("",!0)]),x(e.$slots,"right-"+(o.prop??l),{},void 0,!0),e.foldable?(n(),f(p,{key:0,onClick:a=>d.value[l]=!d.value[l],class:_(["fold-btn f-0",d.value[l]?"rotate-180":""]),size:"1.5em",name:"CaretTop"},null,8,["onClick","class"])):V("",!0)],8,se),h("div",{class:"body f-fs-fs-w",style:I({"max-height":d.value[l]?"0":"100vh"})},[o.type==="custom"?x(e.$slots,o.prop,{key:0,form:u.value},void 0,!0):(n(!0),y($,{key:1},A(o.fields,(a,P)=>(n(),y($,{key:a.key||P},[o.prop?(n(),f(c,{key:0,className:`f-span-${a.span||e.span}`,field:a,pureText:a.pureText||o.pureText||e.pureText,modelValue:u.value[o.prop][a.prop],"onUpdate:modelValue":s=>u.value[o.prop][a.prop]=s,onChange:t[0]||(t[0]=(s,b)=>i("change",s,b))},{custom:S(({field:s})=>[x(e.$slots,s.prop,{field:s,form:u.value},void 0,!0)]),_:2},1032,["className","field","pureText","modelValue","onUpdate:modelValue"])):(n(),f(c,{key:1,className:`f-span-${a.span||e.span}`,field:a,pureText:a.pureText||o.pureText||e.pureText,modelValue:u.value[a.prop],"onUpdate:modelValue":s=>u.value[a.prop]=s,onChange:t[1]||(t[1]=(s,b)=>i("change",s,b))},{custom:S(({field:s})=>[x(e.$slots,s.prop,{field:s,form:u.value},void 0,!0)]),_:2},1032,["className","field","pureText","modelValue","onUpdate:modelValue"]))],64))),128))],4)],2))),128)):(n(),y("div",ne,"空空如也~"))],2),!e.pureText&&e.footer?(n(),f(te,{key:0,loading:e.loading,moreBtns:e.moreBtns,submitText:e.submitText,resetText:e.resetText,formRef:C.value,isOmit:e.isOmit,log:e.log,debug:e.debug,params:w.value,fetch:e.fetch,fetchSuccess:e.fetchSuccess,fetchFail:e.fetchFail,noSubmitProps:e.noSubmitProps,handleReq:e.handleReq,disabled:!g.value.length,onMoreBtns:t[2]||(t[2]=(o,l,a)=>i("moreBtns",o,l,a)),onSubmit:t[3]||(t[3]=o=>i("submit",o)),ref_key:"footerBtnsRef",ref:O},null,8,["loading","moreBtns","submitText","resetText","formRef","isOmit","log","debug","params","fetch","fetchSuccess","fetchFail","noSubmitProps","handleReq","disabled"])):V("",!0)]),_:3},16,["model"])}}});const ce=oe(ue,[["__scopeId","data-v-b9e6c559"]]);export{ce as S};
